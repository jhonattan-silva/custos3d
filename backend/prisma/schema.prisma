// Schema do Prisma para sistema de precificação de peças 3D
// Documentação: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

// Modelo de usuários
model Usuario {
  id                  Int         @id @default(autoincrement())
  email               String?     @unique
  senha               String?
  provedorOauth       String?     @map("provedor_oauth")
  idProvedorOauth     String?     @map("id_provedor_oauth")
  tipoPlano           String      @default("gratuito") @map("tipo_plano")
  criadoEm            DateTime    @default(now()) @map("criado_em")
  atualizadoEm        DateTime    @updatedAt @map("atualizado_em")
  
  // Relacionamento com planilhas
  planilhas           Planilha[]
  
  @@map("usuarios")
}

// Modelo de planilhas
model Planilha {
  id                    Int      @id @default(autoincrement())
  idUsuario             Int      @map("id_usuario")
  nome                  String   @default("Minha Planilha")
  dadosBase             Json     @map("dados_base")
  colunasPersonalizadas Json     @map("colunas_personalizadas")
  criadaEm              DateTime @default(now()) @map("criada_em")
  atualizadaEm          DateTime @updatedAt @map("atualizada_em")
  
  // Relacionamento com usuário
  usuario               Usuario  @relation(fields: [idUsuario], references: [id], onDelete: Cascade)
  
  @@map("planilhas")
}
